# Задание 

<p class="question-text">На вход сервису поступают обновления документов.<br>
```<br>
message TDocument {<br>
&nbsp; &nbsp; string Url = 1; &nbsp;// URL документа, его уникальный идентификатор<br>
&nbsp; &nbsp; uint64 PubDate = 2; &nbsp;// время заявляемой публикации документа<br>
&nbsp; &nbsp; uint64 FetchTime = 3; // время получения данного обновления документа, может рассматриваться как идентификатор версии. Пара (Url, FetchTime) уникальна.<br>
&nbsp; &nbsp; string Text = 4; // текст документа<br>
&nbsp; &nbsp; uint64 FirstFetchTime = 5; // изначально отсутствует, необходимо заполнить<br>
}<br>
```<br>
Документы могут поступать в произвольном порядке (не в том, как они обновлялись), также возможно дублирование отдельных сообщений.<br>
<br>
Необходимо на выходе формировать такие же сообщения, но с исправленными отдельными полями по следующим правилам (всё нижеуказанное - для группы документов с совпадающим полем Url):
<ul>
	<li>Поля Text и FetchTime должны быть такими, какими были в документе с наибольшим FetchTime, полученным на данный момент.</li>
	<li>Поле PubDate должно быть таким, каким было у сообщения с наименьшим FetchTime.</li>
	<li>Поле FirstFetchTime должно быть равно минимальному значению FetchTime.</li>
</ul>
Т. е. в каждый момент времени мы берём PubDate и FirstFetchTime от самой первой из полученных на данный момент версий (если отсортировать их по FetchTime), а Text - от самой последней.<br>
<br>
Интерфейс в коде можно реализовать таким:<br>
```<br>
type Processor interface {<br>
&nbsp;Process(d *Document) (*Document, error)<br>
}<br>
```<br>
<br>
Данный код будет работать в сервисе, читающим входные сообщения из очереди сообщений (Kafka или подобное), и записывающем результат также в очередь. Если Process возвращает `nil` - то в очередь ничего не пишется.<br>
<br>
БД можно описать интерфейсами (при необходимости использования) с пояснениями (может примерным sql) для понимания, какая логика скрывается за интерфейсом и почему, любые текстовые пояснения приветствуются.<br>
<br>
Код должен быть готов к работе в `боевой` среде на столько, на сколько возможно (учтено масштабирование, синхронизация и т.п., если такое возможно).<br>
<br>
Тесты так же приветствуются.<br>
<br>
<em>В поле ответа вставь ссылку на репозиторий GitHub.</em></p>